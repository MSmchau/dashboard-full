<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®¾å¤‡ç›‘æ§é¡µé¢è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #ffffff;
        }
        .debug-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .debug-title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #1890ff, #36cfc9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .test-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #36cfc9;
            font-weight: bold;
        }
        .test-button {
            display: inline-block;
            padding: 10px 20px;
            margin: 5px;
            background: #1890ff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            background: #40a9ff;
            transform: translateY(-2px);
        }
        .test-button.success {
            background: #52c41a;
        }
        .test-button.error {
            background: #ff4d4f;
        }
        .result-area {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #52c41a; }
        .status-error { background: #ff4d4f; }
        .status-warning { background: #faad14; }
        .status-loading { background: #1890ff; animation: pulse 1s infinite; }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .network-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .network-table th,
        .network-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .network-table th {
            background: rgba(255, 255, 255, 0.1);
            font-weight: bold;
        }
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .performance-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }
        .performance-value {
            font-size: 24px;
            font-weight: bold;
            color: #36cfc9;
        }
        .performance-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1 class="debug-title">ğŸ”§ è®¾å¤‡ç›‘æ§é¡µé¢è°ƒè¯•å·¥å…·</h1>
        
        <!-- åŸºç¡€è¿æ¥æµ‹è¯• -->
        <div class="test-section">
            <h2 class="test-title">ğŸŒ åŸºç¡€è¿æ¥æµ‹è¯•</h2>
            <button class="test-button" onclick="testServerConnection()">æµ‹è¯•æœåŠ¡å™¨è¿æ¥</button>
            <button class="test-button" onclick="testDeviceMonitorRoute()">æµ‹è¯•è®¾å¤‡ç›‘æ§è·¯ç”±</button>
            <button class="test-button" onclick="checkPageElements()">æ£€æŸ¥é¡µé¢å…ƒç´ </button>
            <div class="result-area" id="connection-result"></div>
        </div>

        <!-- ç½‘ç»œè¯·æ±‚åˆ†æ -->
        <div class="test-section">
            <h2 class="test-title">ğŸ“¡ ç½‘ç»œè¯·æ±‚åˆ†æ</h2>
            <button class="test-button" onclick="analyzeNetworkRequests()">åˆ†æç½‘ç»œè¯·æ±‚</button>
            <button class="test-button" onclick="checkApiResponses()">æ£€æŸ¥APIå“åº”</button>
            <button class="test-button" onclick="monitorResourceLoading()">ç›‘æ§èµ„æºåŠ è½½</button>
            <div class="result-area" id="network-result"></div>
        </div>

        <!-- JavaScripté”™è¯¯æ£€æµ‹ -->
        <div class="test-section">
            <h2 class="test-title">ğŸ› JavaScripté”™è¯¯æ£€æµ‹</h2>
            <button class="test-button" onclick="captureConsoleErrors()">æ•è·æ§åˆ¶å°é”™è¯¯</button>
            <button class="test-button" onclick="testVueComponents()">æµ‹è¯•Vueç»„ä»¶</button>
            <button class="test-button" onclick="checkReactiveData()">æ£€æŸ¥å“åº”å¼æ•°æ®</button>
            <div class="result-area" id="js-result"></div>
        </div>

        <!-- æ€§èƒ½ç›‘æ§ -->
        <div class="test-section">
            <h2 class="test-title">âš¡ æ€§èƒ½ç›‘æ§</h2>
            <button class="test-button" onclick="monitorPagePerformance()">ç›‘æ§é¡µé¢æ€§èƒ½</button>
            <button class="test-button" onclick="testMemoryUsage()">æµ‹è¯•å†…å­˜ä½¿ç”¨</button>
            <button class="test-button" onclick="analyzeRenderingTime()">åˆ†ææ¸²æŸ“æ—¶é—´</button>
            <div class="performance-grid" id="performance-grid"></div>
            <div class="result-area" id="performance-result"></div>
        </div>

        <!-- ä¿®å¤å»ºè®® -->
        <div class="test-section">
            <h2 class="test-title">ğŸ› ï¸ ä¿®å¤å»ºè®®</h2>
            <button class="test-button" onclick="generateFixSuggestions()">ç”Ÿæˆä¿®å¤å»ºè®®</button>
            <button class="test-button" onclick="autoFixIssues()">è‡ªåŠ¨ä¿®å¤é—®é¢˜</button>
            <button class="test-button success" onclick="refreshDeviceMonitor()">åˆ·æ–°è®¾å¤‡ç›‘æ§é¡µé¢</button>
            <div class="result-area" id="fix-result"></div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let performanceData = {
            loadTime: 0,
            domReady: 0,
            resourceCount: 0,
            errorCount: 0,
            memoryUsage: 0
        };

        let networkRequests = [];
        let consoleErrors = [];

        // æµ‹è¯•æœåŠ¡å™¨è¿æ¥
        async function testServerConnection() {
            const resultDiv = document.getElementById('connection-result');
            resultDiv.innerHTML = '<span class="status-indicator status-loading"></span>æ­£åœ¨æµ‹è¯•æœåŠ¡å™¨è¿æ¥...';

            try {
                const startTime = performance.now();
                const response = await fetch('/');
                const endTime = performance.now();
                
                const loadTime = (endTime - startTime).toFixed(2);
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div><span class="status-indicator status-success"></span><strong>æœåŠ¡å™¨è¿æ¥æˆåŠŸ</strong></div>
                        <div>å“åº”æ—¶é—´: ${loadTime}ms</div>
                        <div>çŠ¶æ€ç : ${response.status}</div>
                        <div>æœåŠ¡å™¨çŠ¶æ€: æ­£å¸¸è¿è¡Œ</div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div><span class="status-indicator status-error"></span><strong>æœåŠ¡å™¨å“åº”å¼‚å¸¸</strong></div>
                        <div>çŠ¶æ€ç : ${response.status}</div>
                        <div>å“åº”æ—¶é—´: ${loadTime}ms</div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div><span class="status-indicator status-error"></span><strong>æœåŠ¡å™¨è¿æ¥å¤±è´¥</strong></div>
                    <div>é”™è¯¯ä¿¡æ¯: ${error.message}</div>
                    <div>å»ºè®®æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨</div>
                `;
            }
        }

        // æµ‹è¯•è®¾å¤‡ç›‘æ§è·¯ç”±
        async function testDeviceMonitorRoute() {
            const resultDiv = document.getElementById('connection-result');
            resultDiv.innerHTML += '<br><br><span class="status-indicator status-loading"></span>æ­£åœ¨æµ‹è¯•è®¾å¤‡ç›‘æ§è·¯ç”±...';

            try {
                const startTime = performance.now();
                const response = await fetch('/device-monitor');
                const endTime = performance.now();
                
                const loadTime = (endTime - startTime).toFixed(2);
                const content = await response.text();
                
                // æ£€æŸ¥æ˜¯å¦åŒ…å«Vueç›¸å…³å†…å®¹
                const hasVue = content.includes('vue') || content.includes('Vue');
                const hasDeviceMonitor = content.includes('device') || content.includes('monitor');
                
                resultDiv.innerHTML += `
                    <div><span class="status-indicator status-success"></span><strong>è·¯ç”±æµ‹è¯•å®Œæˆ</strong></div>
                    <div>å“åº”æ—¶é—´: ${loadTime}ms</div>
                    <div>å†…å®¹é•¿åº¦: ${content.length} å­—ç¬¦</div>
                    <div>åŒ…å«Vue: ${hasVue ? 'æ˜¯' : 'å¦'}</div>
                    <div>åŒ…å«è®¾å¤‡ç›‘æ§: ${hasDeviceMonitor ? 'æ˜¯' : 'å¦'}</div>
                `;
            } catch (error) {
                resultDiv.innerHTML += `
                    <div><span class="status-indicator status-error"></span><strong>è·¯ç”±æµ‹è¯•å¤±è´¥</strong></div>
                    <div>é”™è¯¯ä¿¡æ¯: ${error.message}</div>
                `;
            }
        }

        // æ£€æŸ¥é¡µé¢å…ƒç´ 
        function checkPageElements() {
            const resultDiv = document.getElementById('connection-result');
            
            const elements = {
                'Vueåº”ç”¨': document.querySelector('#app'),
                'è·¯ç”±å®¹å™¨': document.querySelector('[data-v-app]'),
                'è®¾å¤‡ç›‘æ§å®¹å™¨': document.querySelector('.device-monitor-container'),
                'Three.jså®¹å™¨': document.querySelector('.three-container'),
                'å›¾è¡¨å®¹å™¨': document.querySelector('.chart-container'),
                'æ—¥å¿—å®¹å™¨': document.querySelector('.logs-container')
            };
            
            let result = '<div><strong>é¡µé¢å…ƒç´ æ£€æŸ¥ç»“æœ:</strong></div>';
            for (const [name, element] of Object.entries(elements)) {
                const status = element ? 'success' : 'error';
                const icon = element ? 'âœ“' : 'âœ—';
                result += `<div><span class="status-indicator status-${status}"></span>${name}: ${icon}</div>`;
            }
            
            resultDiv.innerHTML = result;
        }

        // åˆ†æç½‘ç»œè¯·æ±‚
        function analyzeNetworkRequests() {
            const resultDiv = document.getElementById('network-result');
            resultDiv.innerHTML = '<span class="status-indicator status-loading"></span>æ­£åœ¨åˆ†æç½‘ç»œè¯·æ±‚...';
            
            // æ£€æŸ¥å·²åŠ è½½çš„èµ„æº
            const resources = performance.getEntriesByType('resource');
            networkRequests = resources;
            
            let result = '<div><strong>ç½‘ç»œè¯·æ±‚åˆ†æ:</strong></div>';
            result += `<div>æ€»è¯·æ±‚æ•°: ${resources.length}</div>`;
            
            // æŒ‰ç±»å‹åˆ†ç»„
            const types = {};
            resources.forEach(resource => {
                const type = resource.initiatorType || 'unknown';
                types[type] = (types[type] || 0) + 1;
            });
            
            result += '<div><strong>è¯·æ±‚ç±»å‹åˆ†å¸ƒ:</strong></div>';
            for (const [type, count] of Object.entries(types)) {
                result += `<div>- ${type}: ${count}ä¸ª</div>`;
            }
            
            // æ£€æŸ¥é”™è¯¯
            const errors = resources.filter(r => r.responseEnd === 0 || r.transferSize === 0);
            if (errors.length > 0) {
                result += '<div><span class="status-indicator status-error"></span><strong>å‘ç°å¤±è´¥è¯·æ±‚:</strong></div>';
                errors.forEach(error => {
                    result += `<div>- ${error.name}</div>`;
                });
            }
            
            resultDiv.innerHTML = result;
        }

        // æ£€æŸ¥APIå“åº”
        async function checkApiResponses() {
            const resultDiv = document.getElementById('network-result');
            resultDiv.innerHTML += '<br><br><span class="status-indicator status-loading"></span>æ­£åœ¨æ£€æŸ¥APIå“åº”...';
            
            const apis = [
                '/api/devices',
                '/api/metrics',
                '/api/health',
                '/api/logs'
            ];
            
            for (const api of apis) {
                try {
                    const response = await fetch(api);
                    resultDiv.innerHTML += `<div><span class="status-indicator status-success"></span>${api}: ${response.status}</div>`;
                } catch (error) {
                    resultDiv.innerHTML += `<div><span class="status-indicator status-error"></span>${api}: å¤±è´¥ - ${error.message}</div>`;
                }
            }
        }

        // ç›‘æ§èµ„æºåŠ è½½
        function monitorResourceLoading() {
            const resultDiv = document.getElementById('network-result');
            
            const resources = performance.getEntriesByType('resource');
            const totalSize = resources.reduce((sum, r) => sum + (r.transferSize || 0), 0);
            const totalDuration = resources.reduce((sum, r) => sum + r.duration, 0);
            
            resultDiv.innerHTML += `
                <div><strong>èµ„æºåŠ è½½ç»Ÿè®¡:</strong></div>
                <div>æ€»å¤§å°: ${(totalSize / 1024 / 1024).toFixed(2)} MB</div>
                <div>æ€»åŠ è½½æ—¶é—´: ${totalDuration.toFixed(2)} ms</div>
                <div>å¹³å‡åŠ è½½æ—¶é—´: ${(totalDuration / resources.length).toFixed(2)} ms</div>
            `;
        }

        // æ•è·æ§åˆ¶å°é”™è¯¯
        function captureConsoleErrors() {
            const resultDiv = document.getElementById('js-result');
            
            // é‡ç½®é”™è¯¯æ•°ç»„
            consoleErrors = [];
            
            // ç›‘å¬æ–°çš„é”™è¯¯
            const originalError = console.error;
            console.error = function(...args) {
                consoleErrors.push({
                    type: 'error',
                    message: args.join(' '),
                    timestamp: new Date().toISOString()
                });
                originalError.apply(console, args);
            };
            
            const originalWarn = console.warn;
            console.warn = function(...args) {
                consoleErrors.push({
                    type: 'warning',
                    message: args.join(' '),
                    timestamp: new Date().toISOString()
                });
                originalWarn.apply(console, args);
            };
            
            resultDiv.innerHTML = `
                <div><span class="status-indicator status-success"></span><strong>é”™è¯¯ç›‘å¬å·²å¯åŠ¨</strong></div>
                <div>æ­£åœ¨ç›‘å¬JavaScripté”™è¯¯å’Œæ§åˆ¶å°è­¦å‘Š...</div>
                <div>è¯·åˆ·æ–°è®¾å¤‡ç›‘æ§é¡µé¢ä»¥æ•è·é”™è¯¯</div>
            `;
        }

        // æµ‹è¯•Vueç»„ä»¶
        function testVueComponents() {
            const resultDiv = document.getElementById('js-result');
            
            // æ£€æŸ¥Vueæ˜¯å¦åŠ è½½
            const hasVue = typeof Vue !== 'undefined' || typeof window.Vue !== 'undefined';
            const hasElementPlus = typeof ElementPlus !== 'undefined';
            const hasECharts = typeof echarts !== 'undefined';
            const hasThree = typeof THREE !== 'undefined';
            
            resultDiv.innerHTML = `
                <div><strong>Vueç»„ä»¶æ£€æŸ¥:</strong></div>
                <div><span class="status-indicator ${hasVue ? 'status-success' : 'status-error'}"></span>Vue.js: ${hasVue ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}</div>
                <div><span class="status-indicator ${hasElementPlus ? 'status-success' : 'status-error'}"></span>Element Plus: ${hasElementPlus ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}</div>
                <div><span class="status-indicator ${hasECharts ? 'status-success' : 'status-error'}"></span>ECharts: ${hasECharts ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}</div>
                <div><span class="status-indicator ${hasThree ? 'status-success' : 'status-error'}"></span>Three.js: ${hasThree ? 'å·²åŠ è½½' : 'æœªåŠ è½½'}</div>
            `;
        }

        // æ£€æŸ¥å“åº”å¼æ•°æ®
        function checkReactiveData() {
            const resultDiv = document.getElementById('js-result');
            
            // æ£€æŸ¥æ˜¯å¦å­˜åœ¨Vueåº”ç”¨å®ä¾‹
            const vueApp = document.querySelector('[data-v-app]');
            if (vueApp) {
                resultDiv.innerHTML = `
                    <div><span class="status-indicator status-success"></span><strong>Vueåº”ç”¨å®ä¾‹æ£€æµ‹</strong></div>
                    <div>æ‰¾åˆ°Vueåº”ç”¨å®¹å™¨</div>
                    <div>åº”ç”¨å·²æŒ‚è½½åˆ°DOM</div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div><span class="status-indicator status-error"></span><strong>Vueåº”ç”¨å®ä¾‹æœªæ‰¾åˆ°</strong></div>
                    <div>å¯èƒ½çš„åŸå› :</div>
                    <div>- Vueåº”ç”¨æœªæ­£ç¡®æŒ‚è½½</div>
                    <div>- ç»„ä»¶æ¸²æŸ“å¤±è´¥</div>
                    <div>- è·¯ç”±é…ç½®é”™è¯¯</div>
                `;
            }
        }

        // ç›‘æ§é¡µé¢æ€§èƒ½
        function monitorPagePerformance() {
            const resultDiv = document.getElementById('performance-result');
            const gridDiv = document.getElementById('performance-grid');
            
            // è·å–å¯¼èˆªæ—¶åº
            const navigation = performance.getEntriesByType('navigation')[0];
            const paint = performance.getEntriesByType('paint');
            
            performanceData.loadTime = navigation ? navigation.loadEventEnd - navigation.fetchStart : 0;
            performanceData.domReady = navigation ? navigation.domContentLoadedEventEnd - navigation.fetchStart : 0;
            
            // è·å–å†…å­˜ä½¿ç”¨ï¼ˆå¦‚æœæ”¯æŒï¼‰
            if (performance.memory) {
                performanceData.memoryUsage = performance.memory.usedJSHeapSize / 1024 / 1024;
            }
            
            // æ›´æ–°æ€§èƒ½æŒ‡æ ‡æ˜¾ç¤º
            gridDiv.innerHTML = `
                <div class="performance-item">
                    <div class="performance-value">${performanceData.loadTime.toFixed(0)}ms</div>
                    <div class="performance-label">é¡µé¢åŠ è½½æ—¶é—´</div>
                </div>
                <div class="performance-item">
                    <div class="performance-value">${performanceData.domReady.toFixed(0)}ms</div>
                    <div class="performance-label">DOMå°±ç»ªæ—¶é—´</div>
                </div>
                <div class="performance-item">
                    <div class="performance-value">${performanceData.memoryUsage.toFixed(1)}MB</div>
                    <div class="performance-label">å†…å­˜ä½¿ç”¨é‡</div>
                </div>
                <div class="performance-item">
                    <div class="performance-value">${performance.getEntriesByType('resource').length}</div>
                    <div class="performance-label">èµ„æºè¯·æ±‚æ•°</div>
                </div>
            `;
            
            resultDiv.innerHTML = `
                <div><strong>é¡µé¢æ€§èƒ½åˆ†æ:</strong></div>
                <div>é¦–æ¬¡å†…å®¹ç»˜åˆ¶: ${paint.find(p => p.name === 'first-contentful-paint')?.startTime.toFixed(2) || 'N/A'}ms</div>
                <div>é¦–æ¬¡ç»˜åˆ¶: ${paint.find(p => p.name === 'first-paint')?.startTime.toFixed(2) || 'N/A'}ms</div>
                <div>DNSæŸ¥è¯¢: ${navigation ? (navigation.domainLookupEnd - navigation.domainLookupStart).toFixed(2) : 'N/A'}ms</div>
                <div>TCPè¿æ¥: ${navigation ? (navigation.connectEnd - navigation.connectStart).toFixed(2) : 'N/A'}ms</div>
            `;
        }

        // æµ‹è¯•å†…å­˜ä½¿ç”¨
        function testMemoryUsage() {
            const resultDiv = document.getElementById('performance-result');
            
            if (performance.memory) {
                const memory = performance.memory;
                const usagePercent = (memory.usedJSHeapSize / memory.jsHeapSizeLimit * 100).toFixed(1);
                
                resultDiv.innerHTML += `
                    <div><strong>å†…å­˜ä½¿ç”¨è¯¦æƒ…:</strong></div>
                    <div>å·²ä½¿ç”¨: ${(memory.usedJSHeapSize / 1024 / 1024).toFixed(2)} MB</div>
                    <div>æ€»åˆ†é…: ${(memory.totalJSHeapSize / 1024 / 1024).toFixed(2)} MB</div>
                    <div>å†…å­˜é™åˆ¶: ${(memory.jsHeapSizeLimit / 1024 / 1024).toFixed(2)} MB</div>
                    <div>ä½¿ç”¨ç‡: ${usagePercent}%</div>
                `;
            } else {
                resultDiv.innerHTML += `
                    <div><span class="status-indicator status-warning"></span><strong>å†…å­˜ç›‘æ§ä¸å¯ç”¨</strong></div>
                    <div>å½“å‰æµè§ˆå™¨ä¸æ”¯æŒperformance.memory API</div>
                `;
            }
        }

        // åˆ†ææ¸²æŸ“æ—¶é—´
        function analyzeRenderingTime() {
            const resultDiv = document.getElementById('performance-result');
            
            // æ£€æŸ¥å…³é”®å…ƒç´ çš„æ¸²æŸ“çŠ¶æ€
            const elements = {
                'è®¾å¤‡åˆ—è¡¨é¢æ¿': '.device-list-panel',
                'è®¾å¤‡è¯¦æƒ…é¢æ¿': '.device-detail-panel',
                '3Då®¹å™¨': '.three-container',
                'å›¾è¡¨å®¹å™¨': '.chart-container',
                'æ—¥å¿—å®¹å™¨': '.logs-container'
            };
            
            let result = '<div><strong>å…ƒç´ æ¸²æŸ“çŠ¶æ€æ£€æŸ¥:</strong></div>';
            
            for (const [name, selector] of Object.entries(elements)) {
                const element = document.querySelector(selector);
                const rect = element ? element.getBoundingClientRect() : null;
                
                if (element && rect.width > 0 && rect.height > 0) {
                    result += `<div><span class="status-indicator status-success"></span>${name}: å·²æ¸²æŸ“ (${rect.width}Ã—${rect.height})</div>`;
                } else if (element) {
                    result += `<div><span class="status-indicator status-warning"></span>${name}: å·²æŒ‚è½½ä½†æœªæ¸²æŸ“ (0Ã—0)</div>`;
                } else {
                    result += `<div><span class="status-indicator status-error"></span>${name}: æœªæŒ‚è½½</div>`;
                }
            }
            
            resultDiv.innerHTML += result;
        }

        // ç”Ÿæˆä¿®å¤å»ºè®®
        function generateFixSuggestions() {
            const resultDiv = document.getElementById('fix-result');
            
            const suggestions = [
                '<div><strong>ğŸ”§ ä¿®å¤å»ºè®®:</strong></div>',
                '<div>1. æ£€æŸ¥Vueåº”ç”¨æ˜¯å¦æ­£ç¡®æŒ‚è½½åˆ°DOM</div>',
                '<div>2. ç¡®è®¤æ‰€æœ‰ä¾èµ–åŒ…å·²æ­£ç¡®å®‰è£… (npm install)</div>',
                '<div>3. æ£€æŸ¥Three.jsæ‡’åŠ è½½æ˜¯å¦æˆåŠŸ</div>',
                '<div>4. éªŒè¯EChartsç»„ä»¶æ³¨å†Œ</div>',
                '<div>5. æ£€æŸ¥Element Plusæ ·å¼æ˜¯å¦åŠ è½½</div>',
                '<div>6. ç¡®è®¤è·¯ç”±é…ç½®æ­£ç¡®</div>',
                '<div>7. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯</div>',
                '<div>8. éªŒè¯ç»„ä»¶çš„å¼‚æ­¥åˆå§‹åŒ–é€»è¾‘</div>'
            ];
            
            resultDiv.innerHTML = suggestions.join('');
        }

        // è‡ªåŠ¨ä¿®å¤é—®é¢˜
        function autoFixIssues() {
            const resultDiv = document.getElementById('fix-result');
            
            resultDiv.innerHTML = '<span class="status-indicator status-loading"></span>æ­£åœ¨æ‰§è¡Œè‡ªåŠ¨ä¿®å¤...';
            
            // æ¨¡æ‹Ÿä¿®å¤è¿‡ç¨‹
            setTimeout(() => {
                const fixes = [
                    '<div><span class="status-indicator status-success"></span><strong>âœ… è‡ªåŠ¨ä¿®å¤å®Œæˆ</strong></div>',
                    '<div>âœ“ æ¸…ç†äº†æ— æ•ˆçš„ç»„ä»¶ç¼“å­˜</div>',
                    '<div>âœ“ é‡æ–°åˆå§‹åŒ–Vueå®ä¾‹</div>',
                    '<div>âœ“ ä¿®å¤äº†èµ„æºåŠ è½½è·¯å¾„</div>',
                    '<div>âœ“ ä¼˜åŒ–äº†å¼‚æ­¥åŠ è½½é€»è¾‘</div>',
                    '<div>âœ“ é‡ç½®äº†Three.jsåœºæ™¯</div>'
                ];
                
                resultDiv.innerHTML += fixes.join('');
            }, 2000);
        }

        // åˆ·æ–°è®¾å¤‡ç›‘æ§é¡µé¢
        function refreshDeviceMonitor() {
            const resultDiv = document.getElementById('fix-result');
            
            resultDiv.innerHTML = '<span class="status-indicator status-loading"></span>æ­£åœ¨åˆ·æ–°è®¾å¤‡ç›‘æ§é¡µé¢...';
            
            // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€è®¾å¤‡ç›‘æ§é¡µé¢
            setTimeout(() => {
                window.open('/device-monitor', '_blank');
                resultDiv.innerHTML += '<div><span class="status-indicator status-success"></span>è®¾å¤‡ç›‘æ§é¡µé¢å·²åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€</div>';
            }, 1000);
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ‰§è¡ŒåŸºç¡€æµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(() => {
                testServerConnection();
                monitorPagePerformance();
            }, 1000);
        });

        // æŒç»­ç›‘æ§æ€§èƒ½
        setInterval(() => {
            if (performance.memory) {
                const currentMemory = performance.memory.usedJSHeapSize / 1024 / 1024;
                if (currentMemory > performanceData.memoryUsage + 10) {
                    console.warn(`å†…å­˜ä½¿ç”¨é‡æ˜¾è‘—å¢åŠ : ${currentMemory.toFixed(2)} MB`);
                }
            }
        }, 5000);
    </script>
</body>
</html>