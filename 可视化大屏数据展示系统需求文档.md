
# 可视化大屏数据展示系统需求文档
## 产品概述
本产品是面向企业级用户的**实时数据可视化决策系统**，目标用户涵盖运维管理团队、业务管理层、数据分析师等，核心价值是通过前沿技术实现多源数据的实时整合、多维可视化呈现与智能决策支持，解决企业数据孤岛、监控延迟、决策依赖经验判断等痛点，助力从“事后分析”转向“实时决策”。

## 页面功能详述
### 1. 全局数据总览大屏
- **页面功能**：整合企业业务数据、设备运行数据、外部关联数据等多源信息，以可视化方式呈现核心指标、全局态势与异常预警，支持一键下钻分析，为管理层提供全景式数据视图与决策依据。
- **UI布局**：
  - 顶部导航与筛选区：左侧展示系统名称与场景切换菜单（如“生产监控”“业务运营”），右侧包含时间范围筛选器（支持实时/今日/自定义）、AI自然语言查询框、刷新按钮，采用Material Design规范布局适配不同屏幕尺寸。
  - 核心指标看板区：居中展示6-8个核心指标（如设备在线率、业务完成率、实时交易额），采用大字体+动态数字滚动效果，指标卡片支持色彩区分状态（正常/预警/异常），基于autofit.js实现1920*1080设计稿自适应缩放。
  - 多维可视化图表区：占据页面主体，采用Canvas+SVG混合渲染技术，包含动态排序柱状图（展示TOP10业务数据）、WebGL 3D地理空间热力图（展示区域分布数据）、时序折线图（展示趋势数据），支持多图表联动。
  - 智能预警通知区：页面右下角悬浮展示异常告警列表，按严重程度分级（红/黄/蓝），包含告警设备、异常指标、发生时间，支持点击跳转详情。
- **交互逻辑**：
  - 筛选操作：用户输入自然语言查询（如“近3小时华东地区设备故障”）→ 系统通过AI模型解析意图，联动实时数据湖返回结果并更新图表。
  - 图表钻取：用户点击某一图表维度（如某类设备/某区域）→ 触发增量计算机制，下钻展示该维度细分数据，图表采用3000ms平滑过渡动画。
  - 预警处理：用户点击告警条目→ 系统弹窗展示异常指标的特征分布直方图、关联数据趋势，自动推荐可能根因。
  - 场景切换：用户选择顶部场景菜单→ 页面组件通过分层渲染技术实现无刷新切换，保持布局比例一致。

### 2. 设备监控详情页
- **页面功能**：聚焦单设备或设备组的实时运行状态监控，支持设备数字孪生展示、历史数据追溯、异常分析与远程控制入口，适配工业互联网、智慧运维等场景。
- **UI布局**：
  - 设备列表与选择区：左侧固定展示设备树形列表，标注设备ID、当前状态（在线/离线/信号弱），支持搜索与分组筛选，采用虚拟滚动技术支持万级设备流畅加载。
  - 设备3D数字孪生区：页面左侧主体区域，基于WebGL构建设备1:1数字孪生模型，实时映射设备运行状态（如指示灯、转速、温度分布），支持旋转、缩放操作。
  - 实时数据指标区：右侧上方展示设备核心运行指标（如负载率、能耗、运行时长），指标更新采用脏矩形技术仅刷新变化区域，减少渲染开销。
  - 历史趋势与异常分析区：右侧下方包含历史数据趋势图（支持按分钟/小时/天切换）、数据偏差检测图表（基于TensorBoardX可视化特征分布），支持历史数据导出Excel。
- **交互逻辑**：
  - 设备选择：用户点击列表中设备→ 数字孪生模型加载对应设备参数，实时数据区通过WebSocket+SSE双通道同步最新状态，3D模型触发状态切换动画。
  - 时间范围筛选：用户选择历史时间区间→ 系统调用实时数据湖增量查询接口，返回数据后更新趋势图，支持拖拽缩放时间轴。
  - 异常点追溯：用户点击趋势图异常数据点→ 系统弹窗展示该时间点设备运行日志、关联指标变化、异常检测报告（含特征漂移分析）。
  - 远程控制触发：用户点击“参数调整”按钮→ 系统弹出控制面板，输入参数后通过边缘计算节点下发指令，实时返回执行结果与状态反馈。

### 3. 低代码配置页面（扩展页面）
- **页面功能**：面向开发/运维人员提供大屏自定义配置能力，支持拖拽组件、数据源对接、样式调整，无需复杂编码即可快速生成定制化大屏。
- **UI布局**：
  - 左侧组件库：包含图表组件（柱状图/折线图等）、指标卡片、3D模型、文本组件等，支持搜索与分类筛选。
  - 中间画布区：按16:9比例展示大屏编辑界面，支持组件拖拽、缩放、层级调整，实时预览自适应效果。
  - 右侧配置面板：包含组件样式配置（颜色/字体/动画）、数据源对接（支持实时数据湖/IoT设备/API接口）、交互规则设置（联动/下钻）。
- **交互逻辑**：
  - 组件拖拽：用户拖拽组件至画布→ 自动吸附对齐，生成默认样式，支持批量选中与统一配置。
  - 数据源配置：用户选择数据源类型并填写连接信息→ 系统校验连通性，返回字段列表，支持字段映射与过滤条件设置。
  - 大屏发布：用户点击“发布”按钮→ 系统保存配置并生成专属URL，支持嵌入企业OA/ERP系统，同步生成适配多端的展示版本。

# 各页面技术实现细节清单（含技术选型+落地优先级）
## 说明
- 优先级定义：P0（核心必需，无替代方案）、P1（推荐实现，提升核心体验）、P2（可选扩展，场景化需求）
- 技术选型原则：兼顾「前沿性+成熟度」，优先选择社区活跃、文档完善、落地案例丰富的技术栈

---

## 一、全局数据总览大屏
| 功能模块                | 核心技术选型                                                                 | 技术优势说明                                                                 | 落地优先级 |
|-------------------------|------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------|
| 多源数据实时整合        | Apache Flink（实时计算）+ Kafka（消息队列）+ Apache Iceberg（实时数据湖）     | 支持百万级数据/秒处理，低延迟（10ms内），兼容IoT设备、业务系统、日志等多源数据 | P0         |
| 核心指标动态渲染        | 数字滚动动画（countUp.js）+ 脏矩形渲染优化                                   | 避免全量重绘，指标更新流畅无卡顿，适配高频数据刷新场景                         | P0         |
| 自适应布局适配          | autofit.js（大屏适配）+ CSS Grid/Flex（响应式）                              | 一键适配1920*1080/4K等多尺寸大屏，保持布局比例一致，无需单独开发多版本         | P0         |
| 3D地理空间热力图        | Three.js（WebGL封装）+ ECharts-GL（扩展图表）                                | 支持3D空间数据可视化，渲染效率高，支持旋转/缩放交互，视觉冲击力强               | P1         |
| AI自然语言查询          | LangChain（意图解析）+ 轻量化大模型（如Qwen-7B-Chat）+ 数据查询模板           | 无需手动筛选，自然语言直接转化为数据查询，降低非技术用户使用门槛               | P1         |
| 多图表联动              | 状态管理（Pinia/Vuex）+ 增量数据更新机制                                     | 单一操作触发关联图表局部刷新，避免全页重绘，提升交互流畅度                     | P0         |
| 智能预警分级            | 规则引擎（LiteFlow）+ 异常检测算法（基于Z-score/EWMA）                        | 支持自定义预警规则，自动识别数据异常，分级推送（红/黄/蓝）                     | P0         |
| 场景无刷新切换          | 组件分层渲染（Vue3 Suspense/React Suspense）+ 路由懒加载                     | 切换时仅加载差异组件，保持页面布局稳定，提升切换体验（<500ms响应）              | P0         |

---

## 二、设备监控详情页
| 功能模块                | 核心技术选型                                                                 | 技术优势说明                                                                 | 落地优先级 |
|-------------------------|------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------|
| 设备3D数字孪生          | Three.js（WebGL）+ GLTF 2.0（模型格式）+ 实时状态映射插件（three-mesh-ui）    | 支持设备1:1可视化建模，实时同步设备运行状态（指示灯、转速等），Web端轻量化部署 | P1         |
| 万级设备列表流畅加载    | 虚拟滚动（vue-virtual-scroller/React-Window）+ 树形结构组件（TreeV3）          | 仅渲染可视区域设备，内存占用降低80%，支持万级设备无卡顿筛选/搜索               | P0         |
| 实时数据双通道同步      | WebSocket（高频状态）+ SSE（低频日志）+ 断线重连机制                         | 兼顾低延迟（WebSocket，10ms内）和稳定性（SSE降级），避免数据丢失               | P0         |
| 历史数据趋势分析        | ECharts 5.x（时序折线图）+ Apache Doris（OLAP查询）                           | 支持亿级历史数据快速查询（<1s响应），支持拖拽缩放时间轴、数据导出               | P0         |
| 异常检测与根因分析      | TensorFlow.js（前端AI推理）+ 特征漂移检测算法（PSI指标）                      | 前端本地实时分析异常数据，无需后端依赖，快速推荐可能根因（如负载过高→散热问题） | P1         |
| 远程控制指令下发        | EdgeX Foundry（边缘计算）+ MQTT协议（设备通信）                               | 指令通过边缘节点就近下发，降低网络延迟，支持指令执行结果实时反馈               | P2         |
| 设备运行日志可视化      | LogGL（日志可视化）+ 关键词高亮与过滤                                        | 支持日志实时流式展示，快速定位异常时间点关联日志                               | P1         |

---

## 三、低代码配置页面
| 功能模块                | 核心技术选型                                                                 | 技术优势说明                                                                 | 落地优先级 |
|-------------------------|------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------|
| 组件拖拽与布局          | Vue3 + Vite（构建工具）+ vue-draggable-next（拖拽）+ Grid Layout（网格布局）  | 拖拽响应延迟<100ms，支持组件吸附对齐、层级调整，构建速度比Webpack快3倍         | P1         |
| 多数据源适配            | Apache SeaTunnel（数据集成）+ 可视化数据源配置（JSON Schema解析）              | 支持对接实时数据湖、IoT设备、API接口、数据库等10+数据源，无需手动编写适配代码   | P1         |
| 实时预览与自适应校验    | Iframe（隔离环境）+ PostMessage（跨域通信）+ autofit.js（预览适配）            | 预览窗口实时同步配置变化，自动校验布局合理性，避免发布后适配问题               | P1         |
| 组件样式可视化配置      | CSS-in-JS（Styled Components）+ 主题变量系统（Design Token）                  | 支持组件颜色、字体、动画实时调整，保持系统风格统一性                           | P1         |
| 大屏发布与嵌入          | 静态资源CDN（Cloudflare/Vercel）+ 嵌入式SDK（IFrame/Web Component）           | 发布后生成独立URL，支持嵌入企业OA/ERP系统，适配多端展示（PC/大屏/平板）         | P2         |
| 配置版本管理            | GitLab API（版本控制）+ 差异对比工具（Diff2Html）                              | 支持配置历史版本回溯、差异对比，避免误操作导致的配置丢失                       | P2         |

---

## 四、通用支撑技术（全页面复用）
| 技术类别                | 核心技术选型                                                                 | 应用场景                                                                     | 落地优先级 |
|-------------------------|------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------|
| 前端框架                | Vue3 + TypeScript + Vite                                                     | 类型安全，构建速度快，组件复用性强，生态完善（适配大屏可视化场景）             | P0         |
| 状态管理                | Pinia（轻量状态管理）+ 本地缓存（IndexedDB，存储配置/常用数据）                | 降低组件通信复杂度，缓存高频访问数据，减少接口请求                             | P0         |
| 性能监控                | Sentry（前端错误监控）+ Lighthouse（性能指标监控）+ 自定义性能埋点（Fundebug） | 实时监控页面加载/渲染/交互性能，定位卡顿、报错等问题                           | P1         |
| 安全防护                | JWT（身份认证）+ 接口权限控制（RBAC模型）+ XSS/CSRF防护（Axios拦截器）         | 保障大屏数据安全，防止未授权访问和数据泄露                                     | P0         |
| 国际化支持              | Vue I18n + 动态语言包加载                                                     | 支持多语言切换（中/英/日等），适配跨国企业或多区域使用场景                     | P2         |

---

# 技术落地时序规划（按阶段划分）
## 核心原则
- 按「先能用→再好用→再灵活」的逻辑迭代，每个阶段均产出可交付、可验证的成果
- 优先保障核心流程闭环，再逐步叠加高级功能
- 控制每个阶段的开发周期（建议MVP≤8周，优化阶段≤6周，扩展阶段≤8周）

---

## 第一阶段：MVP 阶段（核心可用，8周）
### 阶段目标
- 实现「全局数据总览大屏+设备监控详情页」核心功能闭环
- 支持基础数据实时展示、设备状态监控、简单异常预警
- 适配主流大屏尺寸（1920*1080），性能稳定（页面加载≤3s，数据更新≤100ms）

### 技术实现范围（仅P0优先级）
| 页面                | 核心技术模块                                                                 | 开发重点                                                                 |
|---------------------|------------------------------------------------------------------------------|--------------------------------------------------------------------------|
| 全局数据总览大屏    | 1. 前端框架：Vue3 + TypeScript + Vite<br>2. 数据层：Apache Flink + Kafka + Iceberg<br>3. 布局：autofit.js + CSS Grid/Flex<br>4. 可视化：ECharts 5.x（基础图表：柱状图/折线图）<br>5. 交互：Pinia（状态管理）+ 多图表联动<br>6. 预警：LiteFlow规则引擎 + 基础异常检测（Z-score）<br>7. 安全：JWT认证 + RBAC权限控制 | - 完成多源数据对接（至少支持2类数据源：IoT设备+业务系统）<br>- 核心指标看板+3个基础图表实现<br>- 简单场景切换（2个预设场景）<br>- 异常预警弹窗提示 |
| 设备监控详情页      | 1. 设备列表：虚拟滚动（vue-virtual-scroller）<br>2. 实时同步：WebSocket + 断线重连<br>3. 历史数据：Apache Doris + ECharts时序图<br>4. 通用：IndexedDB本地缓存 | - 支持千级设备列表流畅加载<br>- 单设备实时状态展示（5个核心指标）<br>- 历史数据查询（近7天）+ 简单导出<br>- 设备状态切换（在线/离线/信号弱）展示 |
| 通用支撑            | 1. 性能监控：Sentry错误监控<br>2. 接口请求：Axios + 拦截器（防重复请求/重试）<br>3. 样式：Tailwind CSS（统一设计规范） | - 统一接口请求封装，支持环境切换（开发/测试/生产）<br>- 基础样式规范落地，保证视觉一致性 |

### 交付成果
- 可部署的MVP版本（支持Docker容器化部署）
- 核心功能测试报告（含性能测试：页面加载、数据更新延迟）
- 基础用户操作手册（10页内，含部署说明）

---

## 第二阶段：优化阶段（体验提升，6周）
### 阶段目标
- 提升可视化效果与交互体验，加入部分高级功能
- 支持数据下钻、设备状态可视化增强、AI辅助查询
- 性能优化（页面加载≤2s，万级数据渲染无卡顿）

### 技术实现范围（P1优先级为主）
| 页面                | 核心技术模块                                                                 | 开发重点                                                                 |
|---------------------|------------------------------------------------------------------------------|--------------------------------------------------------------------------|
| 全局数据总览大屏    | 1. 可视化：Three.js + ECharts-GL（3D地理空间热力图）<br>2. 交互：AI自然语言查询（LangChain + 轻量化大模型Qwen-7B-Chat）<br>3. 性能：脏矩形渲染优化 | - 3D热力图实现（支持区域数据可视化）<br>- 自然语言查询支持10+常用场景（如“近1小时设备故障”）<br>- 核心指标更新无卡顿（高频数据≥10次/秒） |
| 设备监控详情页      | 1. 可视化：Three.js + GLTF 2.0（设备3D数字孪生基础版）<br>2. 异常分析：TensorFlow.js（前端AI推理）+ PSI特征漂移检测<br>3. 日志：LogGL（基础日志可视化） | - 完成1类核心设备的3D建模（支持状态映射：指示灯/负载占比）<br>- 异常点自动标记+根因推荐（3类常见异常）<br>- 设备运行日志实时流式展示 |
| 通用支撑            | 1. 性能：Lighthouse性能监控 + 自定义埋点（Fundebug）<br>2. 缓存：Redis分布式缓存（高频数据缓存） | - 页面性能优化至加载≤2s<br>- 高频查询数据缓存命中率≥80%<br>- 全链路性能监控（前端→后端→数据源） |

### 交付成果
- 优化后可上线版本（支持生产环境部署）
- 性能优化报告（对比MVP阶段的提升数据）
- 高级功能使用手册（AI查询+3D孪生操作说明）

---

## 第三阶段：扩展阶段（功能灵活，8周）
### 阶段目标
- 新增「低代码配置页面」，支持自定义大屏生成
- 完善高级功能（远程控制、版本管理、国际化）
- 适配多端展示（大屏/PC/平板），支持大规模部署（万级设备+千级用户）

### 技术实现范围（P2优先级+剩余P1优先级）
| 页面                | 核心技术模块                                                                 | 开发重点                                                                 |
|---------------------|------------------------------------------------------------------------------|--------------------------------------------------------------------------|
| 低代码配置页面      | 1. 拖拽组件：vue-draggable-next + Grid Layout<br>2. 数据源：Apache SeaTunnel（多源适配）<br>3. 预览：Iframe + PostMessage<br>4. 样式：Styled Components + Design Token<br>5. 发布：CDN部署 + 嵌入式SDK | - 支持10+常用组件拖拽（指标卡/基础图表/文本）<br>- 对接3类以上数据源（含API接口/数据库）<br>- 自定义大屏发布+独立URL生成<br>- 支持嵌入企业OA系统 |
| 全局数据总览大屏    | 1. 交互：Vue3 Suspense（组件分层渲染）<br>2. 扩展：多语言（Vue I18n）          | - 场景切换无刷新（支持5个以上场景）<br>- 支持中/英双语切换                  |
| 设备监控详情页      | 1. 远程控制：EdgeX Foundry + MQTT协议<br>2. 日志：日志关键词过滤+导出         | - 支持核心设备参数远程调整（2-3个可配置参数）<br>- 日志导出（Excel/PDF）+ 关键词高亮 |
| 通用支撑            | 1. 版本管理：GitLab API + Diff2Html<br>2. 部署：K8s容器编排 + 弹性伸缩       | - 低代码配置版本回溯（支持5个历史版本）<br>- 支持大规模部署（万级设备接入无性能下降） |

### 交付成果
- 完整产品版本（3个页面全功能落地）
- 管理员操作手册 + 开发者文档（低代码组件开发指南）
- 部署方案（支持K8s集群部署+弹性伸缩）

---

## 阶段依赖与风险提示
1. **依赖关系**：低代码配置页面依赖前两阶段的组件沉淀（需先完成基础图表、指标卡等组件的封装）
2. **风险点**：
   - MVP阶段需提前确认数据源对接权限（避免因数据接入延迟影响进度）
   - 3D数字孪生需提前准备设备模型文件（GLTF格式），建议协调设计资源支持
   - AI自然语言查询需测试大模型响应速度（建议部署轻量化模型至边缘节点，降低延迟）
3. **迭代建议**：每个阶段结束后进行用户验证（邀请3-5名目标用户试用），根据反馈调整下一阶段优先级

